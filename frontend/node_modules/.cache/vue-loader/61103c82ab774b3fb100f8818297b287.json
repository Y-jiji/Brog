{"remainingRequest":"C:\\Users\\YangTianJi\\Desktop\\Code_Projects\\CKAS\\frontend\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\YangTianJi\\Desktop\\Code_Projects\\CKAS\\frontend\\src\\views\\Reader.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Users\\YangTianJi\\Desktop\\Code_Projects\\CKAS\\frontend\\src\\views\\Reader.vue","mtime":1627288354804},{"path":"C:\\Users\\YangTianJi\\Desktop\\Code_Projects\\CKAS\\frontend\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\YangTianJi\\Desktop\\Code_Projects\\CKAS\\frontend\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000},{"path":"C:\\Users\\YangTianJi\\Desktop\\Code_Projects\\CKAS\\frontend\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\YangTianJi\\Desktop\\Code_Projects\\CKAS\\frontend\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KDQppbXBvcnQgKiBhcyBQREZKUyBmcm9tICdwZGZqcy1kaXN0L3dlYnBhY2snDQpleHBvcnQgZGVmYXVsdCB7DQogIG5hbWU6ICdSZWFkZXInLA0KICBkYXRhKCl7DQogICAgcmV0dXJuew0KICAgICAgdXVpZDogIiIsDQogICAgICBwZGZfdXJsOiAiIiwNCiAgICAgIHBkZl9kb2M6IG51bGwsDQogICAgICBwYWdlTnVtOiAwDQogICAgfQ0KICB9LA0KICBtb3VudGVkKCkgew0KICAgIHRoaXMudXVpZCA9IHRoaXMuJHJvdXRlLnF1ZXJ5LnV1aWQ7DQogICAgdGhpcy5wZGZfdXJsID0gdGhpcy5nZXRIb3N0VXJsKCkgKyAnOjUwMDAvcmVhZGVyLycgKyB0aGlzLnV1aWQgKyAnLnBkZic7DQogICAgdGhpcy5sb2FkUGRmKHRoaXMucGRmX3VybCk7DQogIH0sDQogIG1ldGhvZHM6IHsNCiAgICBnZXRIb3N0VXJsKCl7DQogICAgICBsZXQgZnVsbF9wYXRoID0gd2luZG93LmRvY3VtZW50LmxvY2F0aW9uLmhyZWY7DQogICAgICBsZXQgcHJvdG9jb2xfaW5kZXggPSBmdWxsX3BhdGguaW5kZXhPZigiOi8vIik7DQogICAgICBsZXQgcHJvdG9jb2xfc3RyID0gZnVsbF9wYXRoLnN1YnN0cmluZygwLCBwcm90b2NvbF9pbmRleCk7DQogICAgICBsZXQgZnVsbF9wYXRoX3N0cmlwcGVkID0gZnVsbF9wYXRoLnN1YnN0cmluZyhwcm90b2NvbF9pbmRleCArIDMpOw0KICAgICAgbGV0IHJvdXRlcl9wYXRoID0gIHRoaXMuJHJvdXRlLnBhdGg7DQogICAgICBsZXQgaG9zdF9pbmRleCA9IGZ1bGxfcGF0aF9zdHJpcHBlZC5pbmRleE9mKHJvdXRlcl9wYXRoKTsNCiAgICAgIGxldCBmdWxsX2hvc3QgPSBmdWxsX3BhdGhfc3RyaXBwZWQuc3Vic3RyaW5nKDAsIGhvc3RfaW5kZXgpOw0KICAgICAgY29uc29sZS5sb2coZnVsbF9wYXRoKTsNCiAgICAgIGxldCBwcmVkX2luZGV4ID0gZnVsbF9ob3N0Lmxhc3RJbmRleE9mKCI6Iik7DQogICAgICBsZXQgcHVyZV9ob3N0ID0gZnVsbF9ob3N0LnN1YnN0cmluZygwLCBwcmVkX2luZGV4KTsNCiAgICAgIHJldHVybiBwcm90b2NvbF9zdHIgKyAiOi8vIiArIHB1cmVfaG9zdDsNCiAgICB9LA0KICAgIGxvYWRQZGYocGRmX3VybCl7DQogICAgICBsZXQgdGhhdCA9IHRoaXM7DQogICAgICBQREZKUy5nZXREb2N1bWVudChwZGZfdXJsKS5wcm9taXNlLnRoZW4oKHBkZikgPT4gew0KICAgICAgICB0aGF0LnBkZl9kb2MgPSBwZGY7DQogICAgICAgIHRoYXQucGFnZU51bSA9IHBkZi5udW1QYWdlczsNCiAgICAgICAgdGhhdC4kbmV4dFRpY2soKCkgPT4gew0KICAgICAgICAgIHRoYXQucmVuZGVyUGFnZSgxKTsNCiAgICAgICAgfSk7DQogICAgICB9KTsNCiAgICB9LA0KICAgIHJlbmRlclBhZ2UocGFnZV9udW0pew0KICAgICAgbGV0IHRoYXQgPSB0aGlzOw0KICAgICAgdGhpcy5wZGZfZG9jLmdldFBhZ2UocGFnZV9udW0pLnRoZW4oKHBhZ2UpID0+IHsNCiAgICAgICAgdmFyIHNjYWxlID0gMS41DQogICAgICAgIHZhciB2aWV3cG9ydCA9IHBhZ2UuZ2V0Vmlld3BvcnQoe3NjYWxlOiBzY2FsZX0pOw0KICAgICAgICB2YXIgY2FudmFzID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2NhbnZhcycgKyBwYWdlX251bSk7DQogICAgICAgIHZhciBjb250ZXh0ID0gY2FudmFzLmdldENvbnRleHQoJzJkJyk7DQogICAgICAgIGNhbnZhcy5oZWlnaHQgPSB2aWV3cG9ydC5oZWlnaHQ7DQogICAgICAgIGNhbnZhcy53aWR0aCA9IHZpZXdwb3J0LndpZHRoOw0KICAgICAgICB2YXIgcmVuZGVyQ29udGV4dCA9IHsNCiAgICAgICAgICBjYW52YXNDb250ZXh0OiBjb250ZXh0LA0KICAgICAgICAgIHZpZXdwb3J0OiB2aWV3cG9ydCwNCiAgICAgICAgfQ0KICAgICAgICBwYWdlLnJlbmRlcihyZW5kZXJDb250ZXh0KTsNCiAgICAgICAgaWYgKHRoYXQucGFnZXMgPiBwYWdlX251bSkgew0KICAgICAgICAgIHRoYXQucmVuZGVyUGFnZShwYWdlX251bSArIDEpDQogICAgICAgIH0NCiAgICAgIH0pOw0KICAgIH0NCiAgfQ0KfQ0K"},{"version":3,"sources":["Reader.vue"],"names":[],"mappings":";;;;;;;AAOA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Reader.vue","sourceRoot":"src/views","sourcesContent":["<template>\r\n  <div class=\"row\">\r\n    <canvas v-for=\"page in pages\" :id=\"'canvas' + page\" :key=\"page\"></canvas>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport * as PDFJS from 'pdfjs-dist/webpack'\r\nexport default {\r\n  name: 'Reader',\r\n  data(){\r\n    return{\r\n      uuid: \"\",\r\n      pdf_url: \"\",\r\n      pdf_doc: null,\r\n      pageNum: 0\r\n    }\r\n  },\r\n  mounted() {\r\n    this.uuid = this.$route.query.uuid;\r\n    this.pdf_url = this.getHostUrl() + ':5000/reader/' + this.uuid + '.pdf';\r\n    this.loadPdf(this.pdf_url);\r\n  },\r\n  methods: {\r\n    getHostUrl(){\r\n      let full_path = window.document.location.href;\r\n      let protocol_index = full_path.indexOf(\"://\");\r\n      let protocol_str = full_path.substring(0, protocol_index);\r\n      let full_path_stripped = full_path.substring(protocol_index + 3);\r\n      let router_path =  this.$route.path;\r\n      let host_index = full_path_stripped.indexOf(router_path);\r\n      let full_host = full_path_stripped.substring(0, host_index);\r\n      console.log(full_path);\r\n      let pred_index = full_host.lastIndexOf(\":\");\r\n      let pure_host = full_host.substring(0, pred_index);\r\n      return protocol_str + \"://\" + pure_host;\r\n    },\r\n    loadPdf(pdf_url){\r\n      let that = this;\r\n      PDFJS.getDocument(pdf_url).promise.then((pdf) => {\r\n        that.pdf_doc = pdf;\r\n        that.pageNum = pdf.numPages;\r\n        that.$nextTick(() => {\r\n          that.renderPage(1);\r\n        });\r\n      });\r\n    },\r\n    renderPage(page_num){\r\n      let that = this;\r\n      this.pdf_doc.getPage(page_num).then((page) => {\r\n        var scale = 1.5\r\n        var viewport = page.getViewport({scale: scale});\r\n        var canvas = document.getElementById('canvas' + page_num);\r\n        var context = canvas.getContext('2d');\r\n        canvas.height = viewport.height;\r\n        canvas.width = viewport.width;\r\n        var renderContext = {\r\n          canvasContext: context,\r\n          viewport: viewport,\r\n        }\r\n        page.render(renderContext);\r\n        if (that.pages > page_num) {\r\n          that.renderPage(page_num + 1)\r\n        }\r\n      });\r\n    }\r\n  }\r\n}\r\n</script>\r\n"]}]}